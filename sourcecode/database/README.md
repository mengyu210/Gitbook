#数据库

## 索引
   索引是对数据库表中一列或多列的值进行排序的结构，是帮助数据库高效获取数据的数据结构
   
索引的优点:
  - 1、通过创建唯一性索引，可以保证数据库表中每一行的数据的唯一性
  - 2、 可以大大加快数据的检索速度
  - 3、 在使用分组和排序语句进行数据检索时，同样可以显著减少查询中分组和排序的时间
  - 4、 可以加速表和表之间的连接，特别是在实现数据的参考完整性方面特别有意义
  - 5、通过使用索引，可以在查询的过程中，使用**优化隐藏器**，提高系统性能

索引的缺点：
  - 1、创建索引和维护索引要消耗时间，这种时间随着数据量的增加而增加。
  - 2、索引需要占物理空间，除了数据表占数据空间之外，每一个索引还要占一定的物理空间，如果要建立聚簇索引，那么需要的空间就会更大。
  - 3、 当对表中的数据进行增加、删除和修改的时候，索引也要动态的维护，这样就降低了数据的维护速度。

索引的分类:<br>
   - 唯一索引：唯一索引不允许两行具有相同的索引值
   - 主键索引：为表定义一个主键将自动创建主键索引，主键索引是唯一索引的特殊类型。主键索引要求主键中的每个值是唯一的，并且不能为空
   - 聚集索引(Clustered)：表中各行的物理顺序与键值的逻辑（索引）顺序相同，每个表只能有一个
   - 非聚集索引(Non-clustered)：非聚集索引指定表的逻辑顺序。数据存储在一个位置，索引存储在另一个位置，索引中包含指向数据存储位置的指针。可以有多个，小于249个

适合创建索引的字段:<br>
   - 经常作为查询条件的字段
   - 经常作为表连接的字段
   - 经常出现在order by,group by, distinct（去重）后面的字段 例:SELECT DISTINCT 列名称 FROM 表名称
   
   

[https://www.jianshu.com/p/fa8192853184](聚簇索引与非聚簇索引)

## 事务
事务（Transaction）是并发控制的基本单位。所谓的事务，它是一个操作序列，这些操作要么都执行，要么都不执行，它是一个不可分割的工作单位。事务是数据库维护数据一致性的单位，在每个事务结束时，都能保持数据一致性。

事务的四大特性：
      - 原子性 事务作为一个整体被执行 ，要么全部执行，要么全部不执行
	  - 一致性 保证数据库状态从一个一致状态转变为另一个一致状态
	  - 隔离性 多个事务并发执行时，一个事务的执行不应影响其他事务的执行
	  - 持久性 一个事务一旦提交，对数据库的修改应该永久保存

### 事务的并发问题有哪几种<br>
    - 丢失更新: 一个事务的更新覆盖了另一个事务的更新
	- 脏读： 一个事务读取了另一个事务未提交的数据
	- 不可重复读：（修改） 同样条件下两次读取结果不同，也就是说，被读取的数据可以被其他事务修改；
	- 幻读： 幻读的重点在于新增或者删除，同样条件下两次读出来的记录数不一样
	

## 数据库的乐观锁和悲观锁
    - 悲观锁 假定会发生并发冲突，屏蔽一切可能违反数据库完整性的操作
	- 乐观锁 假设不会发生并发冲突，只是在提交操作时检查是否违反数据库完整性
[https://www.open-open.com/lib/view/open1452046967245.html]（深入理解乐观锁与悲观锁）

## 数据库的三大范式

### 第一范式
   - 第一范式（1NF）要求数据库表的每一列都是不可分割的基本数据项，同一列中不能有多个值
   -  若某一列有多个值，可以将该列单独拆分成一个实体，新实体和原实体间是一对多的关系
   -  在任何一个关系数据库中，第一范式（1NF）是对关系模式的基本要求，不满足第一范式（1NF）的数据库就不是关系数据库。

### 第二范式
   - 满足第二范式（2NF）必须先满足第一范式（1NF）
   - 第二范式要求实体中每一行的所有非主属性都必须完全依赖于主键；即：非主属性必须完全依赖于主键。
   - 完全依赖：主键可能由多个属性构成，完全依赖要求不允许存在非主属性依赖于主键中的某一部分属性。
   - 若存在哪个非主属性依赖于主键中的一部分属性，那么要将发生部分依赖的这一若存在哪个非主属性依赖于主键中的一部分属性，那么要将发生部分依赖的这一组若存在哪个非主属性依赖于主键中的一部分属性，那么要将发生部分依赖的这一组属性单独新建一个实体，并且在旧实体中用外键与新实体关联，并且新实体与旧实体间是一对多的关系。
   - 属性单独新建一个实体，并且在旧实体中用外键与新实体关联，并且新实体与旧实体间是一对多的关系。组属性单独新建一个实体，并且在旧实体中用外键与新实体关联，并且新实体与旧实体间是一对多的关系。
### 第三范式
    - 满足第三范式必须先满足第二范式。
	- 第三范式要求：实体中的属性不能是其他实体中的非主属性。因为这样会出现冗余。即：属性不依赖于其他非主属性。
	- 如果一个实体中出现其他实体的非主属性，可以将这两个实体用外键关联，而不是将另一张表的非主属性直接写在当前表中。

## 为什么使用数据索引能提高效率
   - 数据索引的存储是有序的
   - 在有序的情况下，通过索引查询一个数据是无需遍历索引记录的
   - 极端情况下，数据索引的查询效率为二分法查询效率，趋近于log2(N)